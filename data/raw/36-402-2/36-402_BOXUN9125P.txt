Introduction
Preston Jorgensen, an eccentric billionaire who aims to become immortal, is interested in knowing what air pollutant factors are related to non-accidental deaths in order to know whether or not he should spend his enormous fortune to try to reduce pollution. Given in-depth information from the data file 'chicago.csv', which contains data of 5114 observations of Chicago's air quality through 6 relevant variables: time (date of observation), death (number of non-accidental deaths on that date), pm10median (median density of $PM_{10}$ pollution), o3median (median concentration of ozone, parts per billion), so2median (median concentration of sulfur dioxide), and tmpd (mean temperature, Farenheit). With this dataset and variables, we will try to answer the following three questions (2). The first being whether air pollutants are associated with increased mortality, and if so, which of these pollutants seems most strongly associated with mortality. The second question to look at is if the effect of pollution is instantaneous or extends over time: in other words, does the amount of pollution on a certain day affect only the death rate of that day or does pollution affect the death rate over the next few days. Lastly, we will consider if the level of each pollutant were lowered to match the lowest value ever recorded, what mean death rate would we estimate for Chicago on a 70-degree day, and if Mr. Jorgensen should spend his fortune to reduce pollution by that much (1). Our final findings indicate that there is indeed a relationship between air pollutants and mortality. Our findings also indicate that air pollutants have effects over time, and are not just instantaneous. (3)
Exploratory Data Analysis
We want to explore the key variables needed to answer our research questions mentioned above. To do this analysis, we will do some exploratory data analysis on our key variables: air pollutant variables, temperature, and our response variable death (1). First, let's take a look at some univariate EDA, or boxplots of our key variables. We can see that the median concentration of ozone pollution, or 'o3median', (parts per billion) falls between -24.779 and 43.688, with mean and median values of -2.179 and -3.326. We can also notice that there is quite a right-skew on the distribution, and some outliers in the plot as well. Moving on to our boxplot of Sulfur Dioxide Pollution, or 'so2median', (sO2), we notice that our values fall between -8.2061 and 28.9034, with mean and median values of -0.6361 and -1.2183 respectively. Our boxplot shows another right-skew distribution, and outliers again to the right end. The outliers suggest that, perhaps, the important values are within closer to that 17 rather than 28. Our next variable is median density of particulate matter pollution, or 'pmp10median', (mg/m^3) and we see that our values are between -37.3761 mg per cubic meter and 320.7248, with mean and median values of -0.1464 and -3.5391 respectively. Our boxplot shows that again, this variable is right-skewed, and that without some outliers, we might want to focus on observations between -40 and 95. Lastly, our boxplot of mean temperature variable, or 'tmpd', (Fahrenheit) is relatively normal with a bit of a left-skew, and the values range from -16 to 92, and our mean and median values are 50.19 and 51 respectively. The left skew of temperature might be explained as Chicago's weather changes frequently depending on the time of the year. After analyzing the boxplots of our key variables, we also wanted to look at the histograms for EDA, and as seen in the histograms above, our graphs seem to confirm our analysis from the boxplots, that the data is right-skewed for our air pollutant variables. The spread for ozone is quite ams. Figure 8, the histogram for this variable, seems to confirm our results from the boxplot, showing the slight left skew. The distribution is approximately normal, but the "center" is rather wide and almost bimodal, as opposed to one even hump. However, the histogram of temperature seems a bit bimodal, with more of a left skew as analyzed earlier, and the bimodal shape could be explained by drastic changes in weather from winter to summer. Now, we want to look at our response variable, death. Because Mr. Jorgensen's goal is to understand the relationship between pollution and mortality, and whether or not he should invest in reducing pollution, our response variable in our analysis will be 'death'. Because we want to proceed with Poisson GAMs with logarithmic link, we must transform our response variable of death into a logarithmic sclae. Therefore, the following histogram and boxplot of death will be log-transformed. We can see from our boxplot that the logarithmic number of non-accidental deaths on a specific day is between 4.234 and 6.019, with mean and median values of 4.740 and 4.736 respectively. The boxplot and histogram seem to show that there is a normal distribution with not a big spread for the average, and that there are some outliers far out to the right. (2). Now we will move on to some multivariate EDA to explore the relationship between predictors and response variable. As we want to do some multivariate EDA, we want to understand more about the relationship between the predictor variables and response variables explored above. As seen in the scatterplot above, we can analyze relationships or trends between death and every corresponding predictor variable, and these scatterplots reveal a lot of vertical clustering for death vs. predictor variables. Because the data is very clustered vertically, we might want to perhaps explore the relationship of these variables through a log-transformation of the variable death and see if the plots are easier to analyze. Before we move on to the log-transformed scatter plots, we want to quickly analyze our response variable log(death) versus time. As seen above, we also have plotted log of death over time, and this might help us identify possible outliers of specific events or dates that could affect or bias our model later on, and in our case, we see three dates, 1995-07-14, 1995-07-15, and 1995-07-16 showing signs of outlying data. Some inspection into these dates reveal that Chicago faced a tremendous heat wave during the July of 1995, resulting in hundreds of deaths in the span of a couple days. Because the cause of death is high levels of heat, and it is related to our variable of temperature, we do not see a need to remove these data observations. Overall, the number of deaths in this plot over time reveal a bit of an up and down pattern, or sinusoidal (3). Above is our pairs plot, or scatterplots of our newly log-transformed death variable versus our key predictor variables (4). With this log-transformation, it is a little bit easier to see the relationship between our response and predictor variables. However, the clustering data, more on the vertical side, is apparent in the scatter plots (5). The log-transform seems to better our analysis, so we moving forward with our modelling and diagnostics we will continue to keep this transformation.
Modeling & Diagnostics
Moving on to Modeling and Diagnostics, we want to make two Poisson models to compare and see how they do with our dataset. The 2 Poisson generalized additive models for our data will have one with unlagged versions of air pollutant variables and another with lagged versions of air pollutant variables. We will use spline smoother terms for all variables, and for simplicity and speed, we will use 4 degrees of freedom for all spline terms (1). Now that we have fitted our two Poisson models, one with lagged and one without lagged air pollutant variables, we want to use cross-validation to determine which of our two models fit our Chicago data better, in terms of prediction error. After running the cross validation, we get the mean square errors: 200.4028 without lagged variables and 186.8249 with lagged variables. We also get our standard errors: 22.14733 without lagged variables and 21.62520 with lagged variables (2). Although the difference between the models do not appear too significant, based on the uncertainty in our estimates of the prediction error, with a differnce of around 14, the model we will choose for our results will be the model with lagged variables based on prediction errors (3).
Results
A global goodness-of-fit test of my model, or an Chi-Square test reveals that there is not enough evidence to reject our lagged variable model. This shows that the model fits well (1). In order to determine whether pollutants are associated with mortality, we want to fit a model that uses only temperature as a feature, and no pollutant variables. Through a hypothesis test of anova, our results show that our p-value is less than 2.2e-16, and our deviance is 236.59. We know through this test that the association between pollutants and mortality is significant to some level, as we know that air pollutant variables do have an effect on mortality (2). The effect of pollution appears to be extended over time, based on our cross-validation results from the previous section. Our lagged model that we selected has a smaller prediction error than that of the model without lagged variables (3). From the plots for our chosen additive model shown above, we look at the average relationship between each variable and the outcome, with uncertainty. The plots reveal that the pollutant that is associated most with mortality is ozone, as the ozone plots show that after a bit of ozone concentration, around 10 parts per billion, we see a huge positive spike, something that isn't seen quite in the other graphs, as some graphs actually have a flatter relationship (4). Now, we want to calculate the smallest value observed for each pollution varialbe, in order to create an estimate, using our model, for the mean number of deaths on a 70-degree day, witht hose levels of pollutants. Our 95% confidence interval for the mean number of deaths is [113.7422, 116.2422], and our estimate will be 114.9840 (5). 6. Use bootstrapping (whichever method you believe is appropriate) to make a 95% confidence interval for the mean number of deaths. Use the pivotal confidence interval and 1000 bootstrap iterations. Report the confidence interval. We want to bootstrap to make a 95% confidence interval for the mean number of deaths. Using the pivotal confidence interval and 1000 bootstrap iterations, we get a confidence interval of [114.4780,114.9618], with mean 114.7240 (6). The difference between the two confidence intervals is that the confidence interval of the bootstrap is much narrower and smaller than that of the smallest values confidence interval. Without bootstrapping, we are ignoring some assumptions, and this might indicate about the model that it is not as good as the bootstrapped one (7).
Conclusions
To summarize our findings about the association between atmospheric pollutants and mortality, we have discovered that there is indeed a relationship between our air pollutant variables and mortality. Additionally, we saw that the effect is not instantaneous, but over time, as our lagged model fit the data better than the non-lagged model (1). We also discovered that some key variables, like ozone had a greater impact on mortality than other air pollutant variables. Therefore, with our modelling and analysis and results, we believe Presten Jorgensen can conclude that reducing pollutants would cause mortality to decrease. However, because of potential overlooked assumptions, inaccuracies in data, or other factors, we can not say that lowering pollution will absolutely decrease mortality (2). Some limitations to our analysis that might have affected our outcome might be the observations that we removed at the start, due to missing data. There is also the fact that this chicago data is limited to cases in chicago, as well as the key variable that we looked at. There could perhaps be other air pollutant variables at play, or non-air related variables that influenced our outcome that we overlooked (3).
