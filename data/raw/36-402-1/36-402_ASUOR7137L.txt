Indroduction
Our generous benefactor Preston Jorgensen has graciously funded this report to investigate whether or not there is any relationship between an animal's lifespan and its characteristics, particularly its metabolic rate. Using the AnAge data, we created a linear model that is able to represent the linear relationship between an animal's maximum lifespan and its metabolic rate. Our resulting best model is a smoothing spline with degrees of freedom of 6 using log-transformations on both the predictor and response variables. Using nonparametric bootstrap for robust estimates, we are able to estimate the expected change in maximum lifespan given a difference in metabolic rate. For a crab-eating raccoon, a 50% change in its metabolic rate does not result in a significant difference in maximum lifespan. We conclude that our resulting model is valid and an accurate estimation of the true relationship between maximum lifespan and metabolic rate, however further investigation with more data and taxonomy diversity should be done to strengthen our understanding of this relationship.
Exploratory Data Analysis
Data
To investigate what factors contribute to an animal's lifespan, we will use the AnAge dataset provided by the Human Ageing Genomic Resources group. The data has 347 observations of 13 variables and all the observations are of the kingdom Animalia and phylum Chordata. We will use the variable Maximum.longevity.yrs as our response variable that represents the maximum lifespan of an animal. Our potential predictors are Metabolic.by.mass, a variable representing the metabolic rate of an animal by its given mass in grams calculated as rate/mass, and Temperature, which is the animal's body temperature in kelvin. The other variables are taxonomy variables which give an animal's classification, but these will not be considered potential predictors because for taxonomy classification of Class and under, some of their levels have 2 observations or less, which cannot be used in linear models. These variables were investigated regardless after removing the classes with too-few observations and it was found that the animal's classification does not contribute to understanding its maximum lifespan because metabolic rate and taxonomy have a significant relationship. The relationship between taxonomy and maximum lifespan is captured in the relationship of metabolic rate and maximum lifespan, and so the inclusion of an animal's classification in a linear model is therefore redundant (insignificant) when modeling maximum lifespan with metabolic rate. This will be briefly shown below in the 1-D and 2-D analysis sections.
1-D Analysis
Our response variable is the maximum lifespan of an animal in years, and our predictors of interest are the metabolic rate (defined as the metabolic rate by an animal's mass) and body temperature in kelvin. The taxonomy Class distribution is shown to illustrate why taxonomy will not be included as a potential predictor. Fig.1 shows the individual distributions of each of these variables below. From the plots in Fig.1, we see that the distributions of our both our maximum lifespan variable and metabolic rate variable are right skewed. The temperature variable is left skewed, and the class taxonomy variable is not evenly distributed amongst its 4 classes and has a class with only 2 observations. Since these variables are so heavily skewed and unevenly distributed, we investigate their relationships with each other to determine if any transformations should be used in modeling. newpage
2-D Analysis
The plots in Fig. 2 show the relationships between our response variable, maximum lifespan, and our two continuous predictors. It does not appear that there is any linear relationship between neither metabolic rate nor temperature with maximum lifespan, but this is likely due to the skewedness of the variable's distributions. We will preform log-transformations on both maximum lifespan and metabolic rate to remedy this. In this case, a log transformation is best to transform the variables to a roughly normal distribution for the sake of modeling any linearity in their relationship as well as preserving the relationship's interpretability. Temperature cannot be transformed to correct its skewed distribution, however, after the log-transformation on maximum lifespan, we find that there is no apparent association between these two variables and so temperature will no longer be considered a potential predictor (plot not shown). Fig.3 below shows the new distributions and summary statistics for the maximum lifespan and metabolic rate variables that will be used for analysis and modeling. The new relationship between the transformed maximum lifespan and metabolic rate variables is shown as well. The summary statistics and univariate plots show that the log-transformed variables now have roughly normal distributions, indicated by the smaller difference between their means (blue dashed lines) and medians (orange dashed lines) as compared to their original distributions. We can also see that the relationship between log-maximum lifespan and log-metabolic rate appears linear and negative, indicating that a lower metabolic rate is correlated with a longer maximum lifespan in animals. log-Maximum Lifespan 0.9163 1.946 2.557 2.508 3.093 4.808 log-Metabolic Rate -9.999 -6.461 -5.802 -5.897 -5.129 -3.184 ggplot(animal_data, aes(x = log(Metabolic.by.mass), y = log(Maximum.longevity.yrs), color = Class)) + geom_point() + geom_rug(aes(x = log(Metabolic.by.mass))) + geom_smooth(method = "lm", se = F) + irb_315_theme + labs(title = "log-Maximum Lifepsan v. log-Metabolic Rate by Class", x = "log-Metabolic Rate (rate/grams)", y = "log-Maximum Lifespan (years)") set.seed(120) lm.fit <- lm(log(Maximum.longevity.yrs) ~ log(Metabolic.by.mass), animal_data) #pander(summary(lm.fit))
Function to compute trace of a matrix
2-D Analysis
tr <- function(A) { return(sum(diag(A))) } B <- 500 n = length(animal_data$Metabolic.by.mass) y.boot <- matrix(0, B, n) yhat.boot <- matrix(0, B, n) for (b in 1:B) { index.b <- sample(1:n, replace=TRUE) boot_animal <- animal_data[index.b, ] x.b <- log(boot_animal$Metabolic.by.mass) y.b <- log(boot_animal$Maximum.longevity.yrs) y.boot[b,] <- y.b yhat.boot[b,] <- fitted(lm(log(Maximum.longevity.yrs) ~ log(Metabolic.by.mass), boot_animal)) } effective_dof_lm <- tr(cov(y.boot,yhat.boot))
10-fold CV
2-D Analysis
K = 10 # number of folds
define folds
2-D Analysis
samp <- sample(c(rep(1:10, nrow(animal_data)/10), sample(1:10, size = 7)), replace = FALSE) # define folds samp <- sample(c(rep(1:10, nrow(animal_data)/10), sample(1:10, size = 7)), replace = FALSE)
empty vector for fold errors
2-D Analysis
err.cv <- rep(NA, 10) for (k in 1:K) { testd <- animal_data[samp == k, ] traind <- animal_data[!(samp == k), ] newdata = data.frame("Metabolic.by.mass" = log(testd$Metabolic.by.mass)) model <- lm(log(Maximum.longevity.yrs) ~ log(Metabolic.by.mass), traind) err.cv[k] <- mean((log(testd$Maximum.longevity.yrs) - predict(model, data.frame(Metabolic.by.mass = testd$Metabolic.by.mass)))^2) } avg.MSE <- mean(err.cv) sd.MSE <- sd(err.cv)/sqrt(K) Terms Estimate Std. Error t value Pr(>|t|) 347 0.6036 0.342 0.3401 pander(c("Average MSE" = avg.MSE, "Std. Error MSE" = sd.MSE, "Dof" = 345, "Eff. Dof" = effective_dof_lm))
Diagnostic Plots
2-D Analysis
par(mfrow = c(2, 2)) plot(lm.fit, which=c(1)) plot(lm.fit, which=c(3)) qqPlot(lm.fit) set.seed(130) df_splines <- 2:7 # degrees of freedom vector K = 10 # number of folds
empty matrix for df by fold errors
2-D Analysis
err.cv <- matrix(NA, length(2:7), 10) for (k in 1:K) { testd <- animal_data[samp == k, ] traind <- animal_data[!(samp == k), ] y <- log(traind$Maximum.longevity.yrs) x <- log(traind$Metabolic.by.mass) for (ii in 1:length(df_splines)){ # loop over each df for each fold model <- smooth.spline(y ~ x, df = df_splines[ii]) err.cv[ii, k] <- mean((log(testd$Maximum.longevity.yrs) - predict(model, x = log(testd$Metabolic.by.mass))$y)^2) } } avg.MSE <- apply(err.cv,1, mean) sd.MSE <- apply(err.cv,1, sd)/sqrt(K) B <- 500 n = length(animal_data$Metabolic.by.mass) y.boot <- matrix(0, B, n) yhat.boot <- matrix(0, B, n)
Create x0 values to get evenly spaced predictions on data
2-D Analysis
xmin <- min(log(animal_data$Metabolic.by.mass)) xmax <- max(log(animal_data$Metabolic.by.mass)) x0 <- seq(xmin, xmax, length.out = 300) for (b in 1:B) { index.b <- sample(1:n, replace=TRUE) boot_animal <- animal_data[index.b, ] x.b <- log(boot_animal$Metabolic.by.mass) y.b <- log(boot_animal$Maximum.longevity.yrs) y.boot[b,] <- y.b yhat.boot[b,] <- predict(smooth.spline(y.b ~ x.b, df = 5), x = log(boot_animal$Metabolic.by.mass))$y } effective_dof_spl <- tr(cov(y.boot,yhat.boot)) pander(c("Average MSE" = avg.MSE[df_splines[which(min(avg.MSE)==avg.MSE)]], "Std. Error MSE" = sd.MSE[df_splines[which(min(avg.MSE)==avg.MSE)]], "Dof" = df_splines[which(min(avg.MSE)==avg.MSE)], "Eff. Dof" = effective_dof_spl)) # Create x0 values to get evenly spaced predictions on data xmin <- min(log(animal_data$Metabolic.by.mass)) xmax <- max(log(animal_data$Metabolic.by.mass)) x0 <- seq(xmin, xmax, length.out = 300)
Our chosen model
2-D Analysis
spline_fit <- smooth.spline(log(animal_data$Maximum.longevity.yrs) ~ log(animal_data$Metabolic.by.mass), df = 6)
Plot!
2-D Analysis
plot(log(animal_data$Metabolic.by.mass), log(animal_data$Maximum.longevity.yrs), xlab = "Log-Metabolic Rate", ylab = "Log-Maximum Longevity in Years", main = "Smoothing Spline v. Linear Regression Fit") abline(lm.fit$coef, col = "red") lines(x0, predict(spline_fit, x = x0)$y, col = "blue") plot(spline_fit$y, (spline_fit$y - log(animal_data$Maximum.longevity.yrs)), main = "Spline Residual Plot", ylab = "Residuals", xlab = "Fitted Values") abline(0,0) #animal_data[which(animal_data$HAGRID == 1898), c(10, 11, 12,13, 14, 15)] %>% pander() Common name Maximum Lifespan Body Mass (g) Metabolic Rate Temperature (2) If the crab-eating raccoon were to have a 50% slower metabolic rate, its metabolic rate would be 0.0011155. Our model estimates that its mean log-maximum lifespan would be 3.033877, or approximately 20.77 years (rounding down, 20 years). (3) A 95% pivotal confidence interval for this estimate is (2.9252, 3.1421 ), or about (18.638, 23.152) in years. This confidence interval is rather robust because we calculated it nonparametrically with B = 1000. The confidence interval contains the maximum lifespan for the crab-eating raccoon, so we cannot conclude that reducing this animal's metabolic rate by 50% would result in an increase in maximum lifespan. Perhaps if the raccoon could reduce its metabolic rate further, it may be able to, however, with this decrease, we cannot say that it would make a difference in its maximum lifespan.
Conclusions
2-D Analysis
(1) In this report we were able to investigate the relationship between metabolic rate and maximum lifespan and found a negative association between the two variables. We compared a linear model with multiple smoothing splines models and were able to choose the best one that reduced the MSE using robust estimates from 10-fold cross-validation and with each estimate's standard errors. Our best model is a smoothing splines model using 6 degrees of freedom. (2) To Preston Jorgensen, we are unable to conclude that the crab-eating raccoon would be able to prolong its life by reducing its metabolic rate by 50% because our estimate resulted in an insignificant difference between reducing the animal's metabolic rate and not. (3) Since this data is not evenly distributed amongst the Class taxonomy variable or the ones below it, the affect of taxonomy on the relationship between maximum lifespan and metabolic rate may be more informative if we had more observations of the other classes apart from Mammalia. We determined that there is a relationship between metabolic rate and taxonomy, and so gaining more observations in the other classes may have an impact on this linear relationship, but the data is not currently available. In addition, the estimation for maximum lifespan may benefit from some sort of confidence or standardization on this measurement as well, since maximum lifespan is greatly affected by whether or not the animal's lifespan is estimated using, for example, animals that are held in captivity, have access to medical care, or have pressers that result in smaller populations or sickly animals. Understanding when these estimates were drawn and from what data may mitigate differences, such as within taxonomy classification. Further investigation would be beneficial, but our chosen model is valid and a good estimate of the true relationship between metabolic rate and maximum lifespan.
