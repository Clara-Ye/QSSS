sentence,tag1,tag2,tag3,section,notes
"anage <- read.csv(""anage-chordata-data.csv"") anage$Metabolic.by.mass <- anage$Metabolic.rate/anage$Body.mass.g library(tidyverse) library(gridExtra) plot.a <- ggplot(anage, aes(x = Metabolic.by.mass)) + geom_histogram(col = ""black"", fill = ""purple4"", bins = 30) + labs(title = ""Log Metabolic Rate by Mass"", xlab = ""Metabolic Rate by Mass"") plot.b <- ggplot(anage, aes(x = Maximum.longevity.yrs)) + geom_histogram(col = ""black"", fill = ""darkolivegreen2"", bins = 30) + labs(title = ""Log Maximum Lifespan in Years"", xlab = ""Maximum Animal Lifespan in Years"") grid.arrange(plot.a, plot.b) plot.c <- ggplot(anage, aes(x = sqrt(Metabolic.by.mass))) + geom_histogram(col = ""black"", fill = ""purple4"", bins = 30) + labs(title = ""Log Metabolic Rate by Mass"", xlab = ""Metabolic Rate by Mass"") plot.d <- ggplot(anage, aes(x = log(Maximum.longevity.yrs))) + geom_histogram(col = ""black"", fill = ""darkolivegreen2"", bins = 30) + labs(title = ""Log Maximum Lifespan in Years"", xlab = ""Maximum Animal Lifespan in Years"") grid.arrange(plot.c, plot.d) lreg <- lm(log(Maximum.longevity.yrs) ~ log(Metabolic.by.mass), data = anage) summary(lreg) anage2 <- subset(anage, select = c(""Metabolic.by.mass"", ""Maximum.longevity.yrs"")) anage2$Metabolic.by.mass <- log(anage2$Metabolic.by.mass) # transforms the data to log data anage2$Maximum.longevity.yrs <- log(anage2$Maximum.longevity.yrs) # same as above pairs(anage2, lower.pannel = NULL) lreg <- lm(log(Maximum.longevity.yrs) ~ log(Metabolic.by.mass), data = anage)",,,,,
summary(lreg),,,,,
"plot(lreg) lreg <- lm(log(Maximum.longevity.yrs) ~ log(Metabolic.by.mass), data = anage) #summary(lreg) dfss <- 3:7 k <- 5 folds <- sample(rep(1:k, length=nrow(anage2)), replace=FALSE) predss <- matrix(NA, k, length(dfss)) for (fold in 1:k){ train <- anage2[folds != fold, ] test <- anage2[folds == fold, ] for (j in 1:length(dfss)) { ssfit <- smooth.spline(train$Maximum.longevity.yrs ~ train$Metabolic.by.mass, df=dfss[j]) predss[fold,j] <- mean((test$Maximum.longevity.yrs - predict(ssfit, x=test$Metabolic.by.mass)$y)^2) } } predssa <- apply(predss, 2, mean) sdss <- apply(predss, 2, sd) / sqrt(k) sdss # The lowest error is associated with the fifth model (df = 7) and is 0.02341617",,,,,
"plot(dfss, predssa, xlab=""Degrees of Freedom"", ylab=""Prediction MSE"", main=""Spline"") dfssm <- dfss[which.min(predssa)] dfssm # indicates that 7 is the best degrees of freedom ssmod7 <- smooth.spline(train$Maximum.longevity.yrs ~ train$Metabolic.by.mass, df = 7) ssmod6 <- smooth.spline(train$Maximum.longevity.yrs ~ train$Metabolic.by.mass, df = 6) ssmod5 <- smooth.spline(train$Maximum.longevity.yrs ~ train$Metabolic.by.mass, df = 5) ssmod4 <- smooth.spline(train$Maximum.longevity.yrs ~ train$Metabolic.by.mass, df = 4) ssmod3 <- smooth.spline(train$Maximum.longevity.yrs ~ train$Metabolic.by.mass, df = 3) plot6 <- plot(ssmod6, main = ""Spline Model, 6 DF"") plot5 <- plot(ssmod5, main = ""Spline Model, 5 DF"") plot4 <- plot(ssmod4, main = ""Spline Model, 4 DF"") plot3 <- plot(ssmod3, main = ""Spline Model, 3 DF"") plot7 <- plot(ssmod7, main = ""Spline Model, 7 DF"") plot(Maximum.longevity.yrs ~ Metabolic.by.mass, data = anage2, main = ""Anage Data & Smoothing Spline"") anage.spl <- with(anage2, ssmod7) anage.spl lines(anage.spl, col = ""purple"") anage[which(anage$Common.name == ""Crab-eating raccoon""), ]",,,,,
Metabolic by Mass = 0.002231034,,,,,
"anage2[which(anage$Common.name == ""Crab-eating raccoon""), ]",,,,,
Log Metabolic By Mass = -6.10529,,,,,
"predict(ssmod7, x = -6.10529, se.fit = TRUE) # Log Lifespan = 2.637268 exp(2.637268) metabolicover2 <- 0.002231034/2 log.metabolicover2 <- log(metabolicover2) predict(ssmod7, x = log.metabolicover2) # Y = 3.042688 exp(3.042688) #Bootstrap library(boot) corrfun <- function(anage2, idx) { df <- anage2[idx, ] c(cor(df[, 1], df[, 2], method = 'spearman')) } set.seed(15) bootstrap <- boot(anage2, corrfun, R = 1000) boot.ci(boot.out = bootstrap, type = c(""norm"", ""basic"", ""perc"", ""bca"")) #(0.5093601, 0.5912005) exp(-0.6746) exp(-0.5256)",,,,,
,,,,,
