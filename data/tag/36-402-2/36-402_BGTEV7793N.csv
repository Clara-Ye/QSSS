sentence,tag1,tag2,tag3,section,notes
Introduction,,,,,
Our client Mr,,,,,
"Preston Jorgensen, who has the goal of extending his life, is interested in knowing which of three types of pollution (Ozone, Sulfur Dioxide, and Particulate Matter) are most strongly associated with increased deaths",,,,,
"In particular he is interested in the following three areas: if there is evidence that these pollutants are associated with mortality, and which among them demonstrates the strongest association",,,,,
if the effects of pollution are instantaneous or if they extend over time,,,,,
and what the expected death rate in Chicago on a 70-degree day would be if the levels of pollutants were artificially set to their lowest levels (1),,,,,
"To answer this question, we analyzed a dataset of measurements of the air quality in Chicago,IL on each day from January 1987 to the end of December 2000 (2)",,,,,
"Each day's entry contains measurements of particulate matter, ozone, and sulfur dioxide pollution, along with the number of non-accidental deaths recorded that day and the mean temperature of that day",,,,,
"In order to facilitate analysis, entries which had an `NA` value for any of the variables were separated from the dataset, leaving 4012 observations for our use",,,,,
"Our analysis led us to conclude that these atmospheric pollutants do have an affect on mortality, particularly over the span of several days",,,,,
Thus if Mr,,,,,
"Jorgensen were able to lower the levels of these pollutants, we would expect mortality to be lower as well",,,,,
Exploratory Data Analysis,,,,,
Our dataset `chicacgo.csv` is a collection of measurements of air quality in Chicago on each day from January 1987 through December 2000,,,,,
The data contains observations of ten key variables,,,,,
"The first is `time`, which is the observation date in days before/after December 31, 1993",,,,,
"For our purposes, we have converted `time` into the plain date of the observation, in order to facilitate looking for outliers in the data",,,,,
"The predictor variable `pm10median`is the median density of PM10 (particulate matter) pollution, measured in milligrams per cubic meter",,,,,
We can see in Figure 1 that the histogram of this variable has a fairly strong right skew (1),,,,,
"In addition the dataset contains a lagged version of this variable, which is the 7-day average of `pm10median`",,,,,
"The histogram of the lagged variable is more normal than the original, with a weaker right skew",,,,,
"The second predictor variable `o3median` is the median concentration of ozone, measured in parts per billion",,,,,
"The histogram in Figure 2 is more normal than that of the PM10 density, but still demonstrates a significant right skew",,,,,
"As with PM10 density, when we examine the lagged ozone concentration, we can see that the histogram has less of a left skew than the original variable",,,,,
"The third predictor variable `so2median` is the median concentration of sulfur dioxide, measured in parts per billion",,,,,
"We can see in Figure 3 that the histogram of this variable has a fairly strong right skew, and that the skew becomes slightly less pronounced in the histogram of the lagged variable",,,,,
"The final predictor variable `tmpd` is the mean temperature, measured in degrees Fahrenheit",,,,,
"We can see in Figure 4 that, in contrast to the other predictors, the histogram of temperature has a left skew",,,,,
The skew is diminished in the histogram of the lagged variable,,,,,
"The response variable is `death`, which is the number of non-accidental deaths which occurred on each date in the dataset (2)",,,,,
"Since our models will be Poisson GAMs with a log-link, we are interested in looking at the distribution of the log-transformed response variable",,,,,
"As we can see in Figure 5, the distribution of log deaths is roughly normal",,,,,
"We can also note in Figure 6 that the plot of log-deaths over time is fairly cyclical, with just a few outliers (3)",,,,,
"These outlier dates are from 7/13/1995 to 7/16/1995, which is when an extreme heat wave occurred in Chicago",,,,,
"Since temperature is already encoded in the data, we can leave these outliers in our analysis",,,,,
"In addition to examining the univariate distributions of the predictor variables, it is also important to look at their relationships with log-deaths",,,,,
"In the scatterplot matrix shown in Figure 7, we can see that the four standard predictor variables do not immediately demonstrate any strong relationships with log-deaths",,,,,
"PM10 density, ozone concentration, and temperature display a very weak negative trend, while sulfur dioxide concentration displays a very weak positive trend",,,,,
"Since one of our research questions is to determine whether the standard or lagged variables are more strongly associated with the death rate, we will also briefly examine the bivariate distributions between `death` and the lagged predictors",,,,,
"In the scatterplot matrix in Figure 8, there is once again not any immediately visible strong relationships between the lagged predictors and the response",,,,,
"Lagged PM10 density, ozone concentration, and temperature again all show very weak positive trends, while sulfur dioxide concentration demonstrates a weak negative trend (4)",,,,,
"Finally, we will note that there are stronger relationships displayed among the lagged predictor variables in Figure 8",,,,,
"In particular, lagged PM10 density has a fairly strong positive relationship with the other three lagged predictors, and temperature has a positive relationship with both lagged PM10 density and lagged ozone concentration (5)",,,,,
Modeling & Diagnostics,,,,,
Our analysis will focus on two Poisson generalized additive models,,,,,
"Model 1 uses the standard predictor variables (PM10 density, ozone concentration, sulfur dioxide concentration, and temperature), and Model 2 uses the lagged versions of these variables (1)",,,,,
"For each of these predictors, we first fit a spline smoother with 4 degrees of freedom",,,,,
"In order to determine which of these models may be a better fit for our data, we performed 5-fold cross validation",,,,,
The average estimated prediction error and estimated standard error are reported in Table 1 below(2),,,,,
We can see that there is very little difference between the models in terms of the estimated MSE and uncertainty,,,,,
"Since Model 2 has a very slightly smaller estimated MSE and estimated standard error, we will use this model for our subsequent analysis",,,,,
Results,,,,,
##Signif,,,,,
"codes: 0 ‘’ 0.001 ‘’ 0.01 ‘’ 0.05 ‘.’ 0.1 ‘ ’ 1 minpm10 <- min(cleanchi$lag_pm10median) mino3 <- min(cleanchi$lag_o3median) minso2 <- min(cleanchi$lag_so2median) mins<-matrix(NA,nrow=1,ncol=3) colnames(mins)<-c(""PM10"",""O3"",""SO2"") mins[1] <- minpm10 mins[2] <- mino3 mins[3] <- minso2 kable(mins, caption=""Min",,,,,
"Pollutant Levels"") ##NOTE: rmarkdown raised an error but the code worked in rstudio ##newpred <- predict(model2, newdata=data.frame(lag_pm10median=minpm10,",,,,,
se.fit=TRUE),,,,,
"##logistic <- function(x){ exp(x) / (1 + exp(x))} ##conf <- logistic(c(newpred$fit - 2  newpred$se.fit,",,,,,
newpred$fit + 2  newpred$se.fit)),,,,,
"plot(fitted(model2),residuals(model2)) hist(residuals(model2)) B<-1000 n<-nrow(cleanchi) predmat <- matrix(NA,nrow= B,ncol=1) for(b in 1:B) { cases<-sample(n,replace=TRUE) dataf<-cleanchi[cases,] out <- gam(death ~ s(lag_pm10median, k = 4+1, fx=TRUE) + s(lag_o3median, k = 4+1, fx=TRUE) + s(lag_so2median, k = 4+1, fx=TRUE) + s(lag_tmpd, k = 4+1, fx=TRUE), data=dataf, family=poisson) predmat[b]<- predict(out, newdata=data.frame(lag_pm10median=minpm10, lag_o3median=mino3, lag_so2median=minso2, lag_tmpd=70), type=""link"",se.fit=TRUE) }",,,,,
,,,,,
