sentence,section,Context,RQDef,RQJust,Data,MethDef,MethJust,Res,Int,Lim,Struct,Other,Title,notes
I,,,,,,,,,,,,,,
Introduction,,,,,,,,,,,,,,
It is believed that air pollution and extreme temperature are associated with increased deaths,,,,,,,,,,,,,,
"Supported by Mr. Preston Jorgensen, we are allowed to analyze how air pollution and extreme temperature are associated with the mortality rate",,,,,,,,,,,,,,
"To be more specific, we would focus on three pollutants - ozone, sulfur dioxide, and particulate matter - to assess the air pollution level",,,,,,,,,,,,,,
"(1) Firstly, we would search whether there is evidence that these pollutants are associated with increased mortality and which exhibits the strongest association",,,,,,,,,,,,,,
"(2) Then, we would analyze whether the effect of pollution is instantaneous or extends over time. (3) Finally, we would estimate the mean death rate in Chicago on a 70-degree day when each pollutant is lowered to its lowest recorded value",,,,,,,,,,,,,,
This estimation would provide an insight into whether Mr. Jorgensen should invest his money to reduce each pollutant to its lowest level,,,,,,,,,,,,,,
"The dataset we would use (chicago.csv) contains information of Chicago each day from January 1987 to December 2000, including the measurements of air quality, the total number of non-accidental deaths, and the mean temperature",,,,,,,,,,,,,,
"We found that (1) there is adequate evidence that pollutants are associated with increased mortality, among which $O_3$ has the strongest association",,,,,,,,,,,,,,
"(2) Meanwhile, our model shows the effect of pollution affects the death rate over the next few days",,,,,,,,,,,,,,
"However, we are not confident to say this is definitely the case, since the difference between the pollution's instantaneous effect and continuing effect is very small and we may get a different answer from a different sample",,,,,,,,,,,,,,
"(3) Moreover, if each pollutant is lowered to its lowest recorded value, the estimated mean death rate in Chicago on a 70-degree day would be 106.1945 with a 95% confidence interval between 99.75592 and 113.31885",,,,,,,,,,,,,,
II,,,,,,,,,,,,,,
Exploratory Data Analysis,,,,,,,,,,,,,,
2.1 Basic Information,,,,,,,,,,,,,,
The dataset contains 5114 observations of 10 variables,,,,,,,,,,,,,,
"`time` is given as the number of days before or after December 31, 1993",,,,,,,,,,,,,,
So we converted it into calendar date and made it a categorical variable - `date`,,,,,,,,,,,,,,
The rest variables are all quantitative: `death` is the number of non-accidental deaths on that date,,,,,,,,,,,,,,
"`pm10median` is the median density of PM10 pollution, i.e. particulate matter with diameter less than 10 micrometers (milligrams per cubic meter)",,,,,,,,,,,,,,
`o3median` is the median concentration of ozone (parts per billion),,,,,,,,,,,,,,
`so2median` is the median concentration of sulfur dioxide; `tmpd` is originally the mean temperature (Fahrenheit),,,,,,,,,,,,,,
the 4 variables start with `lag_` are the 7-day averages of the original variables,,,,,,,,,,,,,,
Our response variable is `death` and all the rest variables are covariates,,,,,,,,,,,,,,
"To make our work clearer, we split the covatiates into two groups: not lagged variables (`pm10median`, `o3median`, `so2median`, `tmpd`) and lagged variables (`lag_pm10median`, `lag_o3median`, `lag_so2median`, `lag_tmpd`)",,,,,,,,,,,,,,
2.2 Data Processing,,,,,,,,,,,,,,
"Since we are interested in the relationship between extreme temperature and mortality, both extremely high and low temperatures should be considered",,,,,,,,,,,,,,
It is common knowledge that the ideal temperature for comfortable living is 72 F,,,,,,,,,,,,,,
"We created two new variables: $tmpd.diff = |tmpd - 72|, lag_tmpd.diff = |lag_tmpd - 72|$ so that we can treat the effect of extreme temperatures on both ends (extreme high and extreme low) in the same way",,,,,,,,,,,,,,
These two new variables measure how extreme the temperature is on a specific day and over the past few days,,,,,,,,,,,,,,
"In addition, we noticed that there are many NA's in the data",,,,,,,,,,,,,,
"However, given the large number of observations we have, we think it is fine to eliminate the observations with NAs",,,,,,,,,,,,,,
This left us with 4012 observations in total,,,,,,,,,,,,,,
"Meanwhile, from Figure 1, we saw the data contains many outliers",,,,,,,,,,,,,,
There are four days on which the death rate exceeds 200 F (1995/07/13 - 1995/07/16),,,,,,,,,,,,,,
"By googling, we found these dates are during the 1995 Chicago Heat Wave",,,,,,,,,,,,,,
"Since the high death rate is explained by extreme temperature, which is one of the covariates, we should keep these outliers",,,,,,,,,,,,,,
2.3 Exploration,,,,,,,,,,,,,,
"Our key variables are `time`, `pm10median`, `o3median`, `so2median`, `lag_pm10median`, `lag_o3median`, `lag_so2median`, `tmpd.diff`, `lag_tmpd.diff` (defined in 2.2), and the response `death`",,,,,,,,,,,,,,
"Since the response variable is a count number, we assume it follows the Poisson distribution and would like to build a Poisson Regression model with link function $g(mu) = log mu$",,,,,,,,,,,,,,
So we need to plot the response on a log scale to see how it fits with the covariates,,,,,,,,,,,,,,
"With this in mind, we performed log transformation on `death`, and created Figure 2 and 3 for the two groups of covariates (log death appears in both figures)",,,,,,,,,,,,,,
"We made the following observations: First, `lag_o3median`, `tmpd.diff`, and `lag_tmpd.diff` are multimodal, while the rest are unimodal",,,,,,,,,,,,,,
"`tmpd.diff` and `lag_tmpd.diff` are left skewed, while the others are right skewed",,,,,,,,,,,,,,
"We tried to use log transformation and square-root transformation on the skewed covariates, but it did not improve the fit of the data too much",,,,,,,,,,,,,,
So we decided to keep the covariates without any transformations,,,,,,,,,,,,,,
"Second, the correlations between `death` and the lagged variables are larger than their corresponding not lagged variables",,,,,,,,,,,,,,
"(2) So we would expect the effects of pollution extends over time. In addition, the correlation between `death` and `lag_tmpd.diff` is the strongest one",,,,,,,,,,,,,,
"(1) Among the pollutants, `lag_o3median` has the highest correlation, so we would expect it is most strongly associated with mortality",,,,,,,,,,,,,,
"But `death` has a nonlinear relationsihp with many covariates, which means correlations are not very useful",,,,,,,,,,,,,,
So we would find another standard to determine which pollutant has the strongest association in 4.4,,,,,,,,,,,,,,
"Third, the non-linear regression line (red) deviates greatly from the linear regression line (blue) for many covariates",,,,,,,,,,,,,,
"So we would build an addtive model, where each covariate is fitted with a smoothing spline. Forth, the correlations among the covariates are non-zero and some of them are significant, suggesting the covariates are not independent",,,,,,,,,,,,,,
"Fifth, from Figure 4, we plotted the death rate over time (in blue) and computed its moving average over a time window of width 30 days (in black)",,,,,,,,,,,,,,
It shows that `death` is cyclical and reaches peaks during the winter,,,,,,,,,,,,,,
This agrees with that extreme temperature is associated with high mortality,,,,,,,,,,,,,,
"Meanwhile, we saw a spike in death rates in 1995 summer, and the pattern between 1988 and 1990 is distinct from other years because of missing data",,,,,,,,,,,,,,
"Except for these two cases, morality follows a similar trend every year",,,,,,,,,,,,,,
"So we decided not to include `time` in our model, as the observations can be well explained by other variables like `tmpd.diff`",,,,,,,,,,,,,,
III,,,,,,,,,,,,,,
Modeling & Diagnostics,,,,,,,,,,,,,,
3.1 Model Construction,,,,,,,,,,,,,,
"As mentioned in 2.3, since `death` is a count number, we would use Poisson regression with the log link function",,,,,,,,,,,,,,
"Also, since log death shows a non-linear trend with the covariates, we would fit an additive model with spline smoother terms",,,,,,,,,,,,,,
"From Figure 2 and 3, we observed that the relationship between death and each covariate is nonlinear but does not deviate too much from a linear trend, so the smoothing spline will fit well with few effective degrees of freedom (edf) required",,,,,,,,,,,,,,
We set edf as 4 and used cubic regression splines for all terms,,,,,,,,,,,,,,
"In the end, we built two Poisson generalized additive models: one with not lagged covariates and one with lagged covariates",,,,,,,,,,,,,,
"Model A: $E[death|covariates] = exp(beta_0 + r_1(pm10median, edf=4) + r_2(o3median, edf=4) + r_3(so2median, edf=4) + r_4(tmpd.diff, edf=4))$ Model B: $E[death|covariates] = exp(beta_0 + r_1(lag_pm10median, edf=4) + r_2(lag_o3median, edf=4) + r_3(lag_so2median, edf=4) + r_4(lag_tmpd.diff, edf=4))$",,,,,,,,,,,,,,
3.2 Cross-Validation,,,,,,,,,,,,,,
"To compare the two models, we used cross-validation with 10 folds",,,,,,,,,,,,,,
"The mean estimated error (MSE) of model A is 12395.78, and that of model B is 12395.64",,,,,,,,,,,,,,
"The MSE's standard deviation for model A is 65.76276, and that of model B is 65.73493",,,,,,,,,,,,,,
"The MSE of model B is slightly lower, but the decrease amount is smaller than the estimation's standard error",,,,,,,,,,,,,,
So the difference between the models does not appear to be significant,,,,,,,,,,,,,,
"With a different choice of folds, the result could be different",,,,,,,,,,,,,,
"But for now, we would pick the model with the lowest MSE - model B - to continue our study",,,,,,,,,,,,,,
The assumptions of Model B are checked in 4.5,,,,,,,,,,,,,,
IV,,,,,,,,,,,,,,
Results,,,,,,,,,,,,,,
4.1 Global Goodness-of-fit,,,,,,,,,,,,,,
We first conducted a global goodness-of-fit test on the selected model,,,,,,,,,,,,,,
"By performing a deviance test on model B, we compared it to the saturated model where each observation has a separate parameter (a perfect fit model)",,,,,,,,,,,,,,
"The p-value of our test is 0, which means there is significant evidence to reject Model B in favor of the saturated model",,,,,,,,,,,,,,
"This is expected since we fix the edf to 4 in each smoother spline, which constrains the model's flexibility",,,,,,,,,,,,,,
"However, we have to stick with model B due to the limit of computing power we have",,,,,,,,,,,,,,
4.2 Pollutants and Morality,,,,,,,,,,,,,,
"To determine whether the pollutants are associated with mortality, we fitted a new model that use only `lag_tmpd.diff` not the pollutants",,,,,,,,,,,,,,
"Model Lag_tmpt: $E[death|covariates] = exp(beta_0 + r_4(lag_tmpd.diff, edf=4))$ We conducted a deviance test that compares Model Lag_tmpd with Model B",,,,,,,,,,,,,,
"Since the p-values is smaller than 2.2e-16, we have enough evidence to reject the null hypothesis that Model Lag_tmpt is better",,,,,,,,,,,,,,
"(1) Therefore, the pollutants are associated with mortality",,,,,,,,,,,,,,
"However, this does not imply that the they cause high mortality",,,,,,,,,,,,,,
4.3 Instantaneous or Continuing Effect,,,,,,,,,,,,,,
"Based on the cross-validation we did in 3.2, (2) the effect of pollution appears to extend over time. However, we are not confident to conclude that this effect is definitely larger than the pollution's instantaneous effect",,,,,,,,,,,,,,
the MSE of Model A (with not lagged variables) is slightly larger than that of Model B (with lagged variables),,,,,,,,,,,,,,
"However, we also observed larger standard deviation of the MSEs, which means the result could change for a different choice of folds",,,,,,,,,,,,,,
4.4 Pollutant with Strongest Association,,,,,,,,,,,,,,
"For Model B, Figure 5 shows the average relationship between each variable and the outcome, with uncertainty",,,,,,,,,,,,,,
`lag_tmpd.diff` appears to be most associated with mortality because its band of uncertainty is the tightest one,,,,,,,,,,,,,,
"(1) Among the pollutants, `lag_o3median` is most associated with mortality, because it has the tightest band of uncertainty compared to the rest two pollutants",,,,,,,,,,,,,,
4.5 Prediction of Death,,,,,,,,,,,,,,
"We created an estimate for the the mean number of deaths on a 70-degree day with the smallest value observed for each pollution variable: `o3median` = -23.2 (ppb), `so2median` = -7.3 (ppb), `pm10median` = -37.4 (mg per cbm)",,,,,,,,,,,,,,
"Because we only know the temperature on the day is 70 F, which is not a lagged value, we used model A to make the prediction",,,,,,,,,,,,,,
"Although model B works better, but we think model A should be more appropriate to accurately address Jorgensen's request",,,,,,,,,,,,,,
The result is 106.1945 with a 95% confidence interval between 100.2390 and 112.5037 (given by `predict()` working on the link scale),,,,,,,,,,,,,,
We also used bootstrapping to make a 95% pivotal confidence interval for the mean number of deaths,,,,,,,,,,,,,,
"Since we used a Poisson regression additive model, we need to test whether `death` follows the Poisson distribution",,,,,,,,,,,,,,
"Through a dispersion test, we found the response's mean does not equal its variance, which leads to a p-value of 0",,,,,,,,,,,,,,
"Therefore, we decided to use bootstrapping by resampling cases, since we want the distribution of the generated data based on the distribution from which the actual `death` data were drawn",,,,,,,,,,,,,,
"By using 1000 bootstrap iterations, the confidence interval is between 99.75592 and 113.31885",,,,,,,,,,,,,,
"We noticed that the two confidence intervals are different, where the one obtained from bootstrapping is wider",,,,,,,,,,,,,,
This is because the residuals of our model do not follow a normal distribution as we assumed in computing the CI from `predict()`,,,,,,,,,,,,,,
"This is also verified by the qq-plot of Model A's residuals, as the tail of the points deviates from the black line a lot",,,,,,,,,,,,,,
"Meanwhile, the data does not follow the assumption of Model A very well",,,,,,,,,,,,,,
"As we mentioned before, death does not follow a Poisson distribution",,,,,,,,,,,,,,
"Based on these reasons, we think it is better to use the CI from bootstrapping",,,,,,,,,,,,,,
"(3) If each pollution variable is at its smallest value observed, then the estimated mean number of deaths on a 70-degree day will be 106.1945 with a 95% confidence interval between 99.75592 and 113.31885",,,,,,,,,,,,,,
V,,,,,,,,,,,,,,
Conclusions,,,,,,,,,,,,,,
5.1 Main Findings,,,,,,,,,,,,,,
"In our study, (1) there is adequate evidence to conclude that atmospheric pollutants, $SO_2$, PM10, and $O_3$, are associated with mortality, and $O_3$ has the strongest association",,,,,,,,,,,,,,
"From Figure 5, it appears that $SO_2$ is associated with decreased death, while PM10 and $O_3$ are associated with increased morality",,,,,,,,,,,,,,
"However, we also observed that for extremely large values of $SO_2$, the confidence band is very wide. This means we do not have enough data with large values of $SO_2$ to identify the real trend",,,,,,,,,,,,,,
(2) Our model points out that the effect of pollution affects the death rate over the next few days,,,,,,,,,,,,,,
"However, we are not confident to say this is definitely the case",,,,,,,,,,,,,,
"The difference between the pollution's instantaneous effect and continuing effect is very small, and we may get a different answer from a different sample",,,,,,,,,,,,,,
"(3) If each pollutant is reduced to its lowest recorded value, we estimated that the mean number of deaths on a 70-degree day would be 106.1945 with a 95% confidence interval between 99.75592 and 113.31885",,,,,,,,,,,,,,
"However, Preston Jorgensen can not conclude that reducing pollutants would cause morality to decrease to this estimation, because this is observational data",,,,,,,,,,,,,,
We can not conclude any causation relationship,,,,,,,,,,,,,,
"Meanwhile, in the real data, the mean number of deaths on a 70-degree day without any constraints on the pollution is 105.6522, which is smaller than our estimation but within the confidence interval",,,,,,,,,,,,,,
So Preston Jorgensen might not want to spend his fortune to reduce pollution this much,,,,,,,,,,,,,,
"It is possible that, after reducing pollution, the mean of deaths is still higher than the actual mean",,,,,,,,,,,,,,
5.2 Discussion and Limitations,,,,,,,,,,,,,,
We realized that our study has many limitations,,,,,,,,,,,,,,
"First, this was not a causal analysis because we used only observational data",,,,,,,,,,,,,,
So we cannot conclude any causation relationship,,,,,,,,,,,,,,
"Second, we are constrained by our computing power",,,,,,,,,,,,,,
"To save time, we construct a relatively simple model (using 4 degrees of freedom for all spline terms)",,,,,,,,,,,,,,
"However, given the complexity of our data, a more complex model may fit the data better and be able to give more accurate inference and prediction",,,,,,,,,,,,,,
"Third, we do not have enough data with large values of $SO_2$",,,,,,,,,,,,,,
"As stated in 5.1, to better understand the association between $SO_2$ and `death`, we need to have a narrower confidence band that gives more certainty",,,,,,,,,,,,,,
So more data is required,,,,,,,,,,,,,,
"Forth, some assumptions of our model are violated",,,,,,,,,,,,,,
"Since `death` is a count per unit of time, we assumed that it follows Poisson distribution with its mean equal to its variance",,,,,,,,,,,,,,
"But, as shown in 4.5, this is not true",,,,,,,,,,,,,,
So we hope future studies could find a more appropriate distribution of `death` and design a better model,,,,,,,,,,,,,,
"Fifth, currently we only use data from Chicago, but we may need to include data from other places to make our conclusion more generalized",,,,,,,,,,,,,,
,,,,,,,,,,,,,,
