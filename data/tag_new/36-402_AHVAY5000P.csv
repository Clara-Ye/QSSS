sentence,section,Context,RQDef,RQJust,Data,MethDef,MethJust,Res,Int,Lim,Struct,Other,Title,notes
Introduction,,,,,,,,,,,,,,
"Billionaire Preston Jorgensen would like to understand how pollutants are related to deaths, and search for ways to extend his life. (1) There are three aspects that he is particularly interested in",,,,,,,,,,,,,,
"First, are pollutants like ozone, SO$_{2}$, and PM$_{10}$ associated with increased deaths",,,,,,,,,,,,,,
"If so, which of them is most strongly associated with mortality",,,,,,,,,,,,,,
"Second, is the effect of pollution on death instantaneous, or does it extend over time? Third, if each pollutant were lowered to be the lowest value ever recorded, what does the model predict for the mean death rate for Chicago on a 70-degree day",,,,,,,,,,,,,,
Should Jorgensen spend his fortune to reduce pollution,,,,,,,,,,,,,,
"(2) To analyze these questions, I use a dataset that provides air quality measurements and non-accidental death number in Chicago each day from January 1987 to the end of December 2000",,,,,,,,,,,,,,
"The dataset contains 5,114 observations",,,,,,,,,,,,,,
"Each observation includes variables such as death number, median density of PM$_{10}$ pollution, median concentration of ozone, median concentration of SO$_{2}$, and mean temperature",,,,,,,,,,,,,,
"newline (3) The main findings to the three guiding questions are the following: First, pollutants like ozone, SO$_{2}$, and PM$_{10}$ are associated with increased deaths",,,,,,,,,,,,,,
"Among these pollutants, ozone is most strongly associated to mortality",,,,,,,,,,,,,,
"Second, the effect of pollution on death extends over time. Third, if each pollutant were lowered to be the lowest value ever, my model will predict the mean death number for Chicago on a 70-degree day to be between 106.3425 and 114.5066",,,,,,,,,,,,,,
"Since the dataset is an obvervational study, I could not conclude causal effect",,,,,,,,,,,,,,
"Thus, Jorgensen should not spend his fortune to reduce pollution because reducing pollution might not neccessarily cause decreased death",,,,,,,,,,,,,,
Exploratory Data Analysis,,,,,,,,,,,,,,
The research goal is to explore the relationship between mortality and the predictors,,,,,,,,,,,,,,
"(1) The four predicor variables are PM$_{10}$ pollution, ozone, sulfur dioxide, and temperature, or their respective lagged versions",,,,,,,,,,,,,,
"According to Figure 1, the distributions of lagged or unlagged pollutants are slightly right skewed, and the distribution of lagged or unlagged temperature are slightly left skewed",,,,,,,,,,,,,,
"All of the unlagged and lagged predictors are unimodal, except for temperature and lagged temperature, which seem to be bimodal",,,,,,,,,,,,,,
"Table 1 demonstrates the median, mean, min, and max value for each predictor",,,,,,,,,,,,,,
"Variable | Median | Mean | Min | Max chicago$deathLog = log(chicago$death) hist(chicago$deathLog, xlab = ""Log Non-Accidental Death"", main = """")",,,,,,,,,,,,,,
summary(chicago$deathLog),,,,,,,,,,,,,,
"plot(chicago$time, chicago$deathLog, xlab = ""Year"", ylab = ""Log Death"",pch=""."") #idx = which(chicago$deathLog>5.2) #chicago[idx,] names = c(""PM 10"", ""Ozone"", ""SO2"", ""Temperature"", ""Lag PM 10"", ""Lag Ozone"", ""Lag SO2"", ""Lag Temp"", ""Log Death"") pairs(~., data = chicago[,-c(1,5)], pch = ""."", lower.panel=NULL, labels = names) suppressMessages(library(mgcv)) model1 = gam(death ~ s(pm10median, k=5, fx=T)+s(o3median, k=5, fx=T)+s(so2median, k=5, fx=T) +s(tmpd, k=5, fx=T), data=chicago, family=poisson) #summary(model1) model2 = gam(death ~ s(lag_pm10median, k=5, fx=T)+s(lag_o3median, k=5 ,fx=T) +s(lag_so2median, k=5, fx=T)+s(lag_tmpd,k=5, fx=T), data=chicago, family=poisson)",,,,,,,,,,,,,,
summary(model2),,,,,,,,,,,,,,
Model 1 | 200.3191 | 21.30925 Model 2 | 186.6846 | 19.15103 begin{center} Table 2: CV Error and Estimated SE of the Models end{center},,,,,,,,,,,,,,
Results,,,,,,,,,,,,,,
"(1) To test the goodness of fit of model 2, I conduct the following hypothesis test: begin{center} Null Hypothesis: $H_0$: My chosen model (Model 2) is correct end{center} begin{center} Alternative Hypothesis: $H_a$: The saturated model is correct end{center} The saturated model has 4012 degrees of freedom and my model has 17 degrees of freedom",,,,,,,,,,,,,,
The deviance follows a chi-square distribution with 3995 degrees of freeodom,,,,,,,,,,,,,,
"The p value I get is 0, which means that I have sufficient evidence to reject the null hypothesis and conclude that the saturated model fits significantly better than my model",,,,,,,,,,,,,,
"(2) To determine whether the pollutants are associated with mortality, I fist fit a model that uses only temperature as a feature, not the pollutants",,,,,,,,,,,,,,
"Specifically, model 3 is: begin{center}E[log(Death)] = $beta_0$ + s(Lag Temperature)end{center} And I conduct the following hypothesis test: begin{center} Null Hypothesis: $H_0$: Model 3 is correct end{center} begin{center} Alternative Hypothesis: $H_a$: My model (Model 2) is correct end{center} From ANOVA test, the p value is 2.2e-16, which is less than 0.5",,,,,,,,,,,,,,
This means I have sufficient evidence to reject the null hypothesis and conclude that there is association between pollutants and mortality,,,,,,,,,,,,,,
"(3) According to Table 2, the cross validation error for model 1 is 200.3191 and the cross validation error for model 2 is 186.6846",,,,,,,,,,,,,,
"Thus, the effect of pollution appears to extend over time because model 2 has smaller cross validation error than model 1",,,,,,,,,,,,,,
"(4) For my chosen model (Model 2), I then draw the smoother term for each of predictor, with uncertainty",,,,,,,,,,,,,,
"According to Figure 5, the curves for lagged PM$_{10}$ and lagged SO$_2$ are rather flat compared to the curve of ozone",,,,,,,,,,,,,,
"As for the curve of ozone, there is an obvious increasing trend in the curve",,,,,,,,,,,,,,
The slope for the ozone curve seems to be the largest,,,,,,,,,,,,,,
"Thus, among the three pollutants, ozone appears to be most associated with mortality",,,,,,,,,,,,,,
"newpage Moving on, I create CI for mean number of deaths with the three pollutants and temperature",,,,,,,,,,,,,,
(5) Table 3 shows the smallest value observed for each lagged pollutant variable,,,,,,,,,,,,,,
"With these levels of pollutants, my model will predict the mean number of deaths on a 70-degree day to be 110.3491",,,,,,,,,,,,,,
"Using the predicted value and the SE, a 95% confidence interval for the mean number of deaths is (106.3425, 114.5066)",,,,,,,,,,,,,,
Variable |Lag PM$_{10}$| Lag Ozone | Lag SO$_{2}$ pm10 = min(chicago$lag_pm10median) o3 = min(chicago$lag_o3median) so2 = min(chicago$lag_so2median),,,,,,,,,,,,,,
"c(pm10,o3,so2)",,,,,,,,,,,,,,
"new_df = data.frame(lag_pm10median = pm10, lag_o3median = o3, lag_so2median = so2, lag_tmpd = 70) pred = predict(model2, newdata=new_df, type=""link"", se.fit=TRUE) CI_log = c(pred$fit + qnorm(0.025)  pred$se.fit, pred$fit + qnorm(0.975)  pred$se.fit) death_pred = exp(pred$fit) death_CI = exp(CI_log)",,,,,,,,,,,,,,
death_CI,,,,,,,,,,,,,,
"set.seed(107) B = 1000 n = nrow(chicago) spans = matrix(nrow=1, ncol = B) new_df = data.frame(lag_pm10median = pm10, lag_o3median = o3, lag_so2median = so2, lag_tmpd = 70) for (b in 1:B) { row_star = sample(seq(1,n), size = n, replace = T) df_star = chicago[row_star,] m_star = gam(death ~ s(lag_pm10median, k=5, fx=T)+s(lag_o3median, k=5, fx=T)+ s(lag_so2median, k=5, fx=T)+s(lag_tmpd,k=5, fx=T), data=df_star, family=poisson) spans[1,b] = predict(m_star, new_df) } pred = predict(model2, newdata=new_df, type=""link"", se.fit=TRUE) quants = apply(spans, 1, quantile, prob = c(0.025, 0.975)) interval_log = c(2pred$fit-quants[2, ], 2pred$fit - quants[1, ]) interval = exp(interval_log) #interval",,,,,,,,,,,,,,
,,,,,,,,,,,,,,
